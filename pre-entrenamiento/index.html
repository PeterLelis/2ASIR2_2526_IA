<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Documentación IA: Pre-Entrenamiento Local</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <header>
        <h1>Pipeline de Pre-entrenamiento: Nano-Transformer</h1>
        <p>Documentación técnica del desarrollo de un modelo base sobre Apple Silicon</p>
    </header>

    <main class="container">
        <section class="step-card">
            <h2>Paso 1: Preparación del Dataset y Entorno</h2>
            <div class="step-content">
                <div class="image-gallery">
                    <img src="img/Imagen1.png" alt="Preparación de archivos" onclick="openLightbox(this)">
                </div>
                <div class="text-info">
                    <p>El primer paso es definir el "universo" del modelo. En este caso, se prepara el entorno local y se descarga el corpus de texto que servirá como fuente de conocimiento general.</p>
                    <div class="command-block">
                        <code>mkdir ejercicio-pre</code>
                        <code>nano quijote.txt</code>
                        <code>ls -lh</code>
                    </div>
                    <p><strong>Explicación:</strong> Se utiliza la terminal para crear el directorio de trabajo y verificar la integridad del archivo de texto plano.</p>
                </div>
            </div>
        </section>

        <section class="step-card">
            <h2>Paso 2: Definición de Arquitectura y Tokenización</h2>
            <div class="step-content reverse">
                <div class="image-gallery">
                    <img src="img/Imagen2.png" alt="Código fuente entrenar.py" onclick="openLightbox(this)">
                    <img src="img/Imagen3.png" alt="Vista del dataset" onclick="openLightbox(this)">
                </div>
                <div class="text-info">
                    <p>Se implementa un tokenizador a nivel de caracteres y la arquitectura Transformer. Es crucial ajustar el dispositivo a 'mps' para la GPU del Mac Mini.</p>
                    <div class="command-block">
                        <code>python3 -c "import torch; print(torch.__version__)"</code>
                    </div>
                    <p><strong>Explicación:</strong> El tokenizador traduce el lenguaje humano a números que el modelo procesa matemáticamente.</p>
                </div>
            </div>
        </section>

        <section class="step-card">
            <h2>Paso 3: Bucle de Entrenamiento</h2>
            <div class="step-content">
                <div class="image-gallery">
                    <img src="img/Imagen4.png" alt="Progreso del loss" onclick="openLightbox(this)">
                    <img src="img/Imagen5.png" alt="Resultado de entrenamiento" onclick="openLightbox(this)">
                </div>
                <div class="text-info">
                    <p>Durante miles de iteraciones, el modelo ajusta sus parámetros internos prediciendo el siguiente carácter en el texto.</p>
                    <div class="command-block">
                        <code>python3 entrenar.py</code>
                    </div>
                    <p><strong>Explicación:</strong> Se observa cómo el error (loss) desciende desde 4.6 hasta 1.3, indicando que el modelo aprende los patrones estadísticos del lenguaje.</p>
                </div>
            </div>
        </section>

        <section class="step-card interactive-section">
            <h2>Simulador de Hiperparámetros</h2>
            <p>Ajusta las variables para ver el impacto en la calidad del modelo:</p>
            <div class="controls">
                <button onclick="updateSim('iter_low')">Pocas Iteraciones</button>
                <button onclick="updateSim('iter_high')">Muchas Iteraciones</button>
                <button onclick="updateSim('vocab_small')">Vocabulario Reducido</button>
            </div>
            <div class="sim-result">
                <h4 id="sim-title">Selecciona un escenario</h4>
                <p id="sim-desc">El resultado variará según la potencia de cómputo y el volumen de datos.</p>
                <div class="code-preview">
                    <code id="sim-output">Esperando entrada...</code>
                </div>
            </div>
        </section>

        <section class="step-card">
            <h2>Paso 4: Inferencia y Chat Local</h2>
            <div class="step-content reverse">
                <div class="image-gallery">
                    <img src="img/Imagen6.png" alt="Script de chat local" onclick="openLightbox(this)">
                </div>
                <div class="text-info">
                    <p>Finalmente, se ejecuta un script de chat para interactuar con el modelo entrenado y generar texto nuevo.</p>
                    <div class="command-block">
                        <code>python3 chat_local.py</code>
                    </div>
                    <p><strong>Explicación:</strong> El modelo genera texto token a token basándose en las probabilidades aprendidas del texto de Cervantes.</p>
                </div>
            </div>
        </section>

        <section class="error-report">
            <h2>Reporte de Errores y Diagnóstico</h2>
            <table>
                <thead>
                    <tr>
                        <th>Error Detectado</th>
                        <th>Causa</th>
                        <th>Solución Sugerida</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>zsh: command not found: l</td>
                        <td>Error de sintaxis al listar archivos.</td>
                        <td>Usar el comando correcto: <code>ls -la</code>.</td>
                    </tr>
                    <tr>
                        <td>RuntimeError: CUDA setup</td>
                        <td>Código configurado para NVIDIA.</td>
                        <td>Cambiar <code>device</code> a 'mps' en el script.</td>
                    </tr>
                    <tr>
                        <td>Loss estancado</td>
                        <td>Tasa de aprendizaje muy alta.</td>
                        <td>Reducir <code>learning_rate</code> a 1e-4.</td>
                    </tr>
                </tbody>
            </table>
        </section>
    </main>

    <div id="lightbox" class="lightbox" onclick="this.style.display='none'">
        <img id="lightbox-img" src="">
    </div>

    <script src="script.js"></script>
</body>
</html>